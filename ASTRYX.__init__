    def save_to_sql(self, result):
        conn = sqlite3.connect(self.db_path)
        cur = conn.cursor()
        snap = result["state_snapshot"]
        traits = snap["traits"]
        cur.execute("""
            INSERT INTO interactions (
                timestamp, user_input, perception_emotion, perception_intent,
                goal, reply, mood, empathy, directness, caution
            ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
        """, (
            datetime.datetime.utcnow().isoformat(),
            result["user_input"],
            result["perception"].get("emotion"),
            result["perception"].get("intent"),
            result["goal"],
            result["reply"],
            snap["mood"],
            traits.get("empathy"),
            traits.get("directness"),
            traits.get("caution"),
        ))
        conn.commit()
        conn.close()